#include<windows.h>
#include <iostream>

char code[] = "\x60\x83\xEC\x30\xC6\x44\x24\xFF\x00\x83\xEC\x01\x68\x68\x6F\x6F\x6B\x68\x6F\x20\x34\x31\x68\x68\x65\x6C\x6C\x68\x6F\x78\x41\x00\x68\x61\x67\x65\x42\x68\x4D\x65\x73\x73\xC6\x44\x24\xFF\x00\x83\xEC\x01\x66\xC7\x44\x24\xFE\x73\x73\x83\xEC\x02\x68\x64\x64\x72\x65\x68\x72\x6F\x63\x41\x68\x47\x65\x74\x50\xC6\x44\x24\xFF\x00\x83\xEC\x01\x68\x61\x72\x79\x41\x68\x4C\x69\x62\x72\x68\x4C\x6F\x61\x64\xC6\x44\x24\xFF\x00\x83\xEC\x01\x66\xC7\x44\x24\xFE\x6C\x6C\x83\xEC\x02\x68\x33\x32\x2E\x64\x68\x75\x73\x65\x72\x8B\xCC\x51\xE8\x8D\x00\x00\x00\x55\x8B\xEC\x83\xEC\x0C\x56\x64\x8B\x35\x30\x00\x00\x00\x8B\x76\x0C\x8B\x76\x1C\x8B\x36\x8B\x76\x08\x8B\xC6\x5E\x8B\xE5\x5D\xC3\x55\x8B\xEC\x83\xEC\x10\x56\x57\x53\x51\x52\x8B\x55\x08\x8B\x72\x3C\x8D\x34\x32\x8D\x76\x18\x8B\x76\x60\x8D\x34\x16\x8B\x7E\x1C\x8D\x3C\x17\x89\x7D\xFC\x8B\x5E\x20\x8D\x1C\x13\x89\x5D\xF8\x8B\x4E\x24\x8D\x0C\x11\x89\x4D\xF4\x33\xC0\x8B\x7D\x0C\x8B\x4D\x10\xFC\x8B\x75\xF8\x8B\x34\x86\x8D\x34\x16\x40\xF3\xA6\x75\xEB\x48\x33\xFF\x8B\x75\xF4\x66\x8B\x3C\x46\x8B\x75\xFC\x8B\x34\xBE\x8D\x04\x16\x5A\x59\x5B\x5F\x5E\x8B\xE5\x5D\xC2\x0C\x00\x55\x8B\xEC\x83\xEC\x30\x56\x57\x53\x51\x52\xE8\x63\xFF\xFF\xFF\x89\x45\xFC\x6A\x0D\x8B\x5D\x08\x8D\x5B\x0B\x53\xFF\x75\xFC\xE8\x6F\xFF\xFF\xFF\x89\x45\xF8\x6A\x0F\x8D\x5B\x0D\x53\xFF\x75\xFC\xE8\x5E\xFF\xFF\xFF\x89\x45\xF4\x8B\x5D\x08\x53\xFF\x55\xF8\x89\x45\xF0\x8B\x5D\x08\x8D\x5B\x27\x53\xFF\x75\xF0\xFF\x55\xF4\x89\x45\xEC\x6A\x00\x6A\x00\x8B\x5D\x08\x8D\x5B\x33\x53\x6A\x00\xFF\x55\xEC\x5A\x59\x5B\x5F\x5E\x8B\xE5\x5D\xC2\x04\x00";


void _declspec(naked) shellcode() {
	_asm {

		lea eax, code
		push eax
		retn
	}
}
int main1() {
	printf("Hello, World!\n");
	//µ÷ÓÃshellcode
	shellcode();
	return 0;
}